# YouTube 下载问题解决方案

## 问题说明

如果遇到 YouTube 视频下载失败，错误信息为：
```
[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol
```

这是网络连接和 SSL 证书验证问题。

## 已实施的解决方案

程序已经更新，添加了以下优化：

1. **跳过 SSL 证书验证** (`nocheckcertificate: True`)
   - 解决某些网络环境下的 SSL 握手失败问题

2. **增加重试机制**
   - 下载重试：10 次
   - 片段重试：10 次
   - 提取器重试：3 次

3. **增加超时时间**
   - Socket 超时：30 秒
   - 给网络连接更多时间

## 如何使用更新后的版本

1. **关闭当前程序**
2. **重新启动**：双击 `start_gui.bat`
3. **重试下载** YouTube 视频

## 其他可能的解决方案

### 方案 1: 检查网络连接

确保你的网络可以访问 YouTube：
- 打开浏览器访问 https://www.youtube.com
- 确认能正常观看视频

### 方案 2: 使用代理（高级）

如果你的网络环境需要代理访问 YouTube，可以在代码中添加代理设置。

在 `ydl_opts` 中添加：
```python
'proxy': 'http://127.0.0.1:7890',  # 替换为你的代理地址
```

### 方案 3: 更新 yt-dlp

确保使用最新版本的 yt-dlp：
```bash
pip install --upgrade yt-dlp
```

### 方案 4: 使用较低质量

如果高质量视频下载失败，可以尝试选择较低分辨率：
- 从 "best" 改为 "720p" 或 "1080p"

## 测试建议

1. 先尝试下载一个较短的 YouTube 视频（1-2 分钟）
2. 如果成功，再尝试下载较长的视频
3. 如果仍然失败，尝试下载 Bilibili 视频确认程序本身没问题

## 注意事项

⚠️ **关于 SSL 证书验证**
- `nocheckcertificate: True` 会跳过 SSL 证书验证
- 这可能带来轻微的安全风险
- 但对于下载公开视频来说是可接受的
- 这是 yt-dlp 常用的解决方案

## 如果问题仍然存在

可能的原因：
1. **网络限制** - 你的网络环境可能无法直接访问 YouTube
2. **防火墙** - 防火墙或安全软件可能在拦截连接
3. **需要代理** - 某些地区访问 YouTube 需要代理

建议：
- 尝试使用能访问 YouTube 的网络环境
- 暂时关闭防火墙/安全软件测试
- 配置代理（如果你有）

---

**好消息：** Bilibili 视频下载正常！说明程序本身工作正常。
